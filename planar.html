<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>M√¥ ph·ªèng M·∫£ng Anten Ph·∫≥ng - Thang ƒëo dB</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: auto; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 30px; }
        h2, h3 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        .control-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; }
        .input-group { display: flex; flex-direction: column; }
        label { font-size: 0.85em; font-weight: bold; margin-bottom: 5px; color: #555; }
        input { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-primary { background-color: #007bff; color: white; width: 100%; margin-top: 20px; font-size: 16px; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-purple { background-color: #6610f2; color: white; }
        .btn-danger { background-color: #dc3545; color: white; }
        .info-panel { background: #e9ecef; padding: 10px; border-radius: 5px; margin-top: 15px; font-family: monospace; font-size: 14px; }
        .chart-container { width: 100%; height: 600px; }
        header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; padding: 40px; border-radius: 10px; margin-bottom: 30px; 
        }
        .nav-link { display: inline-block; background: #28a745; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-weight: bold; margin-top: 15px; }
    </style>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<div class="container">
    <header style="background: linear-gradient(135deg, #6610f2 0%, #6f42c1 100%); color: white; padding: 40px; border-radius: 10px; margin-bottom: 30px;">
        <h1 style="margin: 0;">Planar Antenna Array Calculator</h1>
        <p style="font-size: 1.1em; opacity: 0.9; max-width: 900px; margin: 15px 0;">
            C√¥ng c·ª• m√¥ ph·ªèng <strong>M·∫£ng Ph·∫≥ng 2 Chi·ªÅu (2D Planar Array)</strong>. 
            Ph√¢n t√≠ch h·ªá s·ªë m·∫£ng trong kh√¥ng gian $u-v$, l√°i b√∫p s√≥ng theo g√≥c $\theta$ v√† $\phi$, c√πng c√°c m·∫∑t c·∫Øt b·ª©c x·∫° 2D tr·ª±c quan.
        </p>
        <div style="font-size: 0.9em; margin-bottom: 15px;">
            ‚ú® Ph√¢n t√≠ch kh√¥ng gian $u-v$ (Balanis) | ‚ú® Qu√©t b√∫p s√≥ng 2D (Beam Steering) | ‚ú® M·∫∑t c·∫Øt Polar $\phi$ (dB Scale)
        </div>
        <a href="index.html" class="nav-link" style="display: inline-block; background: #ffc107; color: #333; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-weight: bold; margin-top: 5px;">‚Üê Quay l·∫°i M·∫£ng Tuy·∫øn t√≠nh (1D)</a>
    </header>
    <div class="card">
        <h2>Th√¥ng s·ªë M·∫£ng Anten Ph·∫≥ng</h2>
        <form id="planarForm">
            <div class="control-grid">
                <div class="input-group"><label>S·ªë ph·∫ßn t·ª≠ X (M):</label><input type="number" id="M" value="5"></div>
                <div class="input-group"><label>S·ªë ph·∫ßn t·ª≠ Y (N):</label><input type="number" id="N" value="5"></div>
                <div class="input-group"><label>dx (m):</label><input type="number" id="dx" value="0.0625" step="any"></div>
                <div class="input-group"><label>dy (m):</label><input type="number" id="dy" value="0.0625" step="any"></div>
                <div class="input-group"><label>T·∫ßn s·ªë f (GHz):</label><input type="number" id="f" value="2.4" step="any"></div>
                <div class="input-group"><label>Pha Œ≤x (ƒë·ªô):</label><input type="number" id="betax" value="0" step="any"></div>
                <div class="input-group"><label>Pha Œ≤y (ƒë·ªô):</label><input type="number" id="betay" value="0" step="any"></div>
            </div>

            <div style="margin-top: 20px; padding: 15px; border: 1px dashed #28a745; border-radius: 8px;">
                <label style="color: #28a745; font-weight: bold;">L√°i b√∫p s√≥ng (Scan Direction):</label>
                <div style="display: flex; gap: 15px; margin-top: 10px; align-items: flex-end;">
                    <div class="input-group"><label>Œ∏‚ÇÄ (ƒë·ªô):</label><input type="number" id="theta0" value="0"></div>
                    <div class="input-group"><label>œÜ‚ÇÄ (ƒë·ªô):</label><input type="number" id="phi0" value="0"></div>
                    <button type="button" id="btnCalcPhase" class="btn-success">C·∫≠p nh·∫≠t Œ≤ t·ª´ g√≥c qu√©t</button>
                </div>
            </div>
            <button type="submit" class="btn-primary">T√çNH TO√ÅN & C·∫¨P NH·∫¨T 3D</button>
        </form>
        <div id="info" class="info-panel"></div>
    </div>

    <div class="card">
        <h3>1. H·ªá t·ªça ƒë·ªô u-v </h3>
        <div id="uvChart" class="chart-container"></div>
    </div>

    <div class="card">
        <h3>2. H·ªá t·ªça ƒë·ªô Oxyz</h3>
        <div id="realSpaceChart" class="chart-container"></div>
    </div>

    <div class="card">
        <h3>3. Ph√¢n t√≠ch m·∫∑t c·∫Øt 2D (Polar Plot - dB Scale)</h3>
        <p style="font-size: 0.9em; color: #666;">Nh·∫≠p g√≥c œÜ ƒë·ªÉ c·∫Øt l·ªõp b·ª©c x·∫°. Thang ƒëo dB gi√∫p nh√¨n r√µ b√∫p ph·ª• (Sidelobes).</p>
        <div style="display: flex; gap: 15px; margin-bottom: 15px; align-items: center;">
            <label>G√≥c c·∫Øt œÜ (ƒë·ªô):</label>
            <input type="number" id="phiCut" value="0" style="width: 80px;">
            <button type="button" id="btnAddCut" class="btn-purple">+ Th√™m m·∫∑t c·∫Øt n√†y</button>
        </div>
        <div id="polarChart" class="chart-container"></div>
        
        <div style="text-align: right; margin-top: 20px;">
            <button type="button" id="btnClearAll" class="btn-danger">üóëÔ∏è X√≥a s·∫°ch & Reset</button>
        </div>
    </div>
</div>

<div class="card" id="theory-section" style="line-height: 1.7;">
        <h2 style="text-align: center; color: #6610f2;">C∆° s·ªü l√Ω thuy·∫øt & C√¥ng th·ª©c (M·∫£ng Ph·∫≥ng)</h2>
        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">

        <h3>1. Gi·ªõi thi·ªáu v·ªÅ M·∫£ng Ph·∫≥ng (Planar Array)</h3>
        <p>
            M·∫£ng ph·∫≥ng l√† s·ª± m·ªü r·ªông c·ªßa m·∫£ng tuy·∫øn t√≠nh b·∫±ng c√°ch s·∫Øp x·∫øp c√°c ph·∫ßn t·ª≠ anten tr√™n m·ªôt m·∫∑t ph·∫≥ng (th∆∞·ªùng l√† m·∫∑t ph·∫≥ng $x-y$). 
            ∆Øu ƒëi·ªÉm v∆∞·ª£t tr·ªôi c·ªßa m·∫£ng ph·∫≥ng so v·ªõi m·∫£ng tuy·∫øn t√≠nh l√† kh·∫£ nƒÉng <strong>l√°i b√∫p s√≥ng trong kh√¥ng gian 3D</strong> (c·∫£ g√≥c $\theta$ v√† $\phi$), 
            ƒë·ªìng th·ªùi ki·ªÉm so√°t ƒë∆∞·ª£c h√¨nh d·∫°ng b√∫p s√≥ng m·ªôt c√°ch linh ho·∫°t h∆°n.
        </p>

        <h3>2. H·ªá s·ªë m·∫£ng ph·∫≥ng (Array Factor - AF)</h3>
        <p>
            X√©t m·ªôt m·∫£ng ph·∫≥ng g·ªìm $M$ ph·∫ßn t·ª≠ d·ªçc theo tr·ª•c $x$ (kho·∫£ng c√°ch $d_x$) v√† $N$ ph·∫ßn t·ª≠ d·ªçc theo tr·ª•c $y$ (kho·∫£ng c√°ch $d_y$). 
            H·ªá s·ªë m·∫£ng t·ªïng qu√°t ƒë∆∞·ª£c t√≠nh b·∫±ng t√≠ch c·ªßa hai h·ªá s·ªë m·∫£ng tuy·∫øn t√≠nh:
        </p>

        <div style="text-align: center; background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #eee;">
            $$ AF_{total}(\theta, \phi) = AF_x \times AF_y $$
            <p>D·∫°ng chu·∫©n h√≥a:</p>
            $$ AF(\theta, \phi) = \left| \frac{\sin(\frac{M}{2}\psi_x)}{M\sin(\frac{1}{2}\psi_x)} \right| \times \left| \frac{\sin(\frac{N}{2}\psi_y)}{N\sin(\frac{1}{2}\psi_y)} \right| $$
        </div>

        <p>Trong ƒë√≥, ƒë·ªô l·ªách pha t·ªïng c·ªông tr√™n m·ªói tr·ª•c l√†:</p>
        <ul>
            <li>$\psi_x = k d_x \sin\theta \cos\phi + \beta_x$</li>
            <li>$\psi_y = k d_y \sin\theta \sin\phi + \beta_y$</li>
        </ul>

        <h3>3. H·ªá t·ªça ƒë·ªô Cosine h∆∞·ªõng ($u-v$ Space)</h3>
        <p>
            ƒê·ªÉ ƒë∆°n gi·∫£n h√≥a vi·ªác ph√¢n t√≠ch m·∫£ng ph·∫≥ng, ta c√≥ th·ªÉ s·ª≠ d·ª•ng bi·∫øn ƒë·ªïi sang kh√¥ng gian $u-v$:
        </p>
        <div style="text-align: center; background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
            $$ u = \sin\theta \cos\phi $$
            $$ v = \sin\theta \sin\phi $$
        </div>
        <p>
            Trong h·ªá t·ªça ƒë·ªô n√†y, <strong>v√πng nh√¨n th·∫•y (visible region)</strong> l√† v√≤ng tr√≤n ƒë∆°n v·ªã th·ªèa m√£n $u^2 + v^2 \le 1$. 
            M·ªçi gi√° tr·ªã n·∫±m ngo√†i v√≤ng tr√≤n n√†y t∆∞∆°ng ·ª©ng v·ªõi c√°c s√≥ng kh√¥ng lan truy·ªÅn (evanescent waves) v√† kh√¥ng b·ª©c x·∫° ra kh√¥ng gian xa.
        </p>

        <h3>4. L√°i b√∫p s√≥ng v√† Pha k√≠ch th√≠ch ($\beta_x, \beta_y$)</h3>
        <p>
            ƒê·ªÉ c·ª±c ƒë·∫°i b·ª©c x·∫° (b√∫p s√≥ng ch√≠nh) h∆∞·ªõng v·ªÅ g√≥c qu√©t mong mu·ªën $(\theta_0, \phi_0)$, ta ph·∫£i ƒëi·ªÅu ch·ªânh pha k√≠ch th√≠ch gi·ªØa c√°c ph·∫ßn t·ª≠ sao cho $\psi_x = 0$ v√† $\psi_y = 0$ t·∫°i h∆∞·ªõng ƒë√≥:
        </p>

        <div style="text-align: center; background: #fff4e5; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #ffeeba;">
            $$ \beta_x = -k d_x \sin\theta_0 \cos\phi_0 $$
            $$ \beta_y = -k d_y \sin\theta_0 \sin\phi_0 $$
        </div>

        <h3>5. C√°c th√¥ng s·ªë ƒë·∫∑c tr∆∞ng tr√™n ƒë·ªì th·ªã Polar (dB Scale)</h3>
        <ul>
            <li><strong>B√∫p s√≥ng ch√≠nh (Main Lobe):</strong> L√† ph·∫ßn b·ª©c x·∫° t·∫≠p trung nƒÉng l∆∞·ª£ng cao nh·∫•t.</li>
            <li><strong>M·ª©c b√∫p ph·ª• (Side Lobe Level - SLL):</strong> T·ªâ s·ªë gi·ªØa ƒë·ªânh b√∫p ph·ª• l·ªõn nh·∫•t v√† ƒë·ªânh b√∫p ch√≠nh. V·ªõi m·∫£ng ƒë·ªÅu, SLL l√Ω t∆∞·ªüng l√† kho·∫£ng $-13.2 \text{ dB}$.</li>
            <li><strong>B√∫p s√≥ng gi·∫£ (Grating Lobes):</strong> Xu·∫•t hi·ªán khi kho·∫£ng c√°ch $d_x$ ho·∫∑c $d_y$ qu√° l·ªõn ($> \lambda$). ƒêi·ªÅu n√†y l√†m xu·∫•t hi·ªán th√™m c√°c ƒë·ªânh b·ª©c x·∫° m·∫°nh b·∫±ng b√∫p ch√≠nh ·ªü c√°c h∆∞·ªõng kh√¥ng mong mu·ªën.</li>
        </ul>

        <h3>6. T√†i li·ªáu tham kh·∫£o</h3>
        <ul style="list-style-type: decimal; padding-left: 20px;">
            <li>Constantine A. Balanis, <em>Antenna Theory: Analysis and Design</em>, 4th Edition, Wiley (Ch∆∞∆°ng 6: Arrays - Planar Arrays).</li>
            <li>Stutzman & Thiele, <em>Antenna Theory and Design</em>, 3rd Edition.</li>
        </ul>
    </div>

<script src="script-planar.js"></script>
</body>
</html>